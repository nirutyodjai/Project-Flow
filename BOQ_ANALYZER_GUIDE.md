# 📊 BOQ Analyzer - คู่มือการใช้งาน

**วันที่:** 3 ตุลาคม 2568  
**ฟีเจอร์:** ถอดรายการวัสดุ-อุปกรณ์-แรงงาน อัตโนมัติจาก BOQ

---

## ✨ ความสามารถ

### 1. **ถอดรายการวัสดุ** 📦
- ชื่อวัสดุ
- ข้อกำหนด (Specification)
- จำนวนที่ใช้ (พร้อม waste factor)
- ราคาต่อหน่วย
- ราคารวม
- ผู้จัดจำหน่าย
- ระยะเวลานำเข้า

### 2. **ถอดรายการแรงงาน** 👷
- ประเภทแรงงาน (ช่างไฟฟ้า, ช่างปูน, etc.)
- ระดับฝีมือ (หัวหน้า, ช่างฝีมือ, ผู้ช่วย)
- จำนวนวันคน (Man-days)
- ค่าจ้างต่อวัน
- ค่าใช้จ่ายรวม

### 3. **ถอดรายการเครื่องมือ** 🔧
- ชื่อเครื่องมือ
- ประเภท (เป็นของเรา/เช่า)
- จำนวนวันที่ใช้
- ค่าเช่าต่อวัน
- ค่าใช้จ่ายรวม

### 4. **คำนวณต้นทุนครบถ้วน** 💰
- ต้นทุนตรง (วัสดุ + แรงงาน + เครื่องมือ)
- ค่าใช้จ่ายทั่วไป (10%)
- ค่าบริหารจัดการ (7%)
- ค่าสำรองความเสี่ยง (5%)
- ภาษี VAT (7%)

### 5. **คำนวณกำไร** 📈
- กำไรขั้นต้น
- กำไรสุทธิ
- เปอร์เซ็นต์กำไร

### 6. **Timeline** ⏱️
- ระยะเวลาโครงการรวม
- Critical Path

---

## 🎯 ตัวอย่างการถอดรายการ

### ตัวอย่าง 1: งานเทคอนกรีตพื้น

**Input:**
```
รายการ: งานเทคอนกรีตพื้น
จำนวน: 100 ตร.ม.
```

**Output - วัสดุที่ถอดได้:**
```
1. คอนกรีตผสมเสร็จ fc = 240 kg/cm²
   - จำนวน: 105 ลบ.ม. (รวม waste 5%)
   - ราคา/หน่วย: 2,800 บาท
   - ราคารวม: 294,000 บาท

2. เหล็กเส้น SD40, DB12
   - จำนวน: 12,000 กก. (120 กก./ตร.ม.)
   - ราคา/หน่วย: 25 บาท
   - ราคารวม: 300,000 บาท
```

**Output - แรงงานที่ถอดได้:**
```
1. หัวหน้างาน (Foreman)
   - จำนวน: 10 วันคน
   - ค่าจ้าง/วัน: 800 บาท
   - รวม: 8,000 บาท

2. ช่างเทคอนกรีต (Skilled)
   - จำนวน: 30 วันคน
   - ค่าจ้าง/วัน: 600 บาท
   - รวม: 18,000 บาท

3. ผู้ช่วย (Helper)
   - จำนวน: 50 วันคน
   - ค่าจ้าง/วัน: 400 บาท
   - รวม: 20,000 บาท
```

**Output - เครื่องมือที่ถอดได้:**
```
1. เครื่องผสมคอนกรีต (เช่า)
   - ใช้งาน: 50 วัน
   - ค่าเช่า/วัน: 500 บาท
   - รวม: 25,000 บาท

2. เครื่องสั่นคอนกรีต (เป็นของเรา)
   - ใช้งาน: 30 วัน
   - ค่าเสื่อม: 3,000 บาท
```

---

### ตัวอย่าง 2: งานก่ออิฐผนัง

**Input:**
```
รายการ: งานก่ออิฐผนัง
จำนวน: 200 ตร.ม.
```

**Output - วัสดุ:**
```
1. อิฐมอญ 3 รู
   - จำนวน: 15,000 ก้อน (75 ก้อน/ตร.ม.)
   - ราคา: 3.5 บาท/ก้อน
   - รวม: 52,500 บาท

2. ปูนซีเมนต์ ตราเสือ
   - จำนวน: 240 ถุง (1.2 ถุง/ตร.ม.)
   - ราคา: 150 บาท/ถุง
   - รวม: 36,000 บาท

3. ทรายหยาบ
   - จำนวน: 6 ลบ.ม. (0.03 ลบ.ม./ตร.ม.)
   - ราคา: 400 บาท/ลบ.ม.
   - รวม: 2,400 บาท
```

**Output - แรงงาน:**
```
1. ช่างก่อ (Skilled)
   - จำนวน: 80 วันคน
   - ค่าจ้าง: 600 บาท/วัน
   - รวม: 48,000 บาท

2. ผู้ช่วย (Helper)
   - จำนวน: 80 วันคน
   - ค่าจ้าง: 400 บาท/วัน
   - รวม: 32,000 บาท
```

---

### ตัวอย่าง 3: งานติดตั้งไฟฟ้า

**Input:**
```
รายการ: งานติดตั้งไฟฟ้า
จำนวน: 50 จุด
```

**Output - วัสดุ:**
```
1. สายไฟ THW 2x2.5 sq.mm
   - จำนวน: 750 เมตร (15 เมตร/จุด)
   - ราคา: 12 บาท/เมตร
   - รวม: 9,000 บาท

2. เต้ารับ 3 รู มีกราวด์
   - จำนวน: 50 ชุด
   - ราคา: 85 บาท/ชุด
   - รวม: 4,250 บาท
```

**Output - แรงงาน:**
```
1. ช่างไฟฟ้า (Skilled)
   - จำนวน: 10 วันคน
   - ค่าจ้าง: 700 บาท/วัน
   - รวม: 7,000 บาท
```

---

## 🚀 วิธีใช้งาน

### 1. เปิดหน้าวิเคราะห์:
```
http://localhost:3000/boq-analyzer
```

### 2. กรอกข้อมูล:
- **ชื่อโครงการ**: โครงการก่อสร้างอาคาร...
- **งบประมาณรวม**: 15,000,000 บาท

### 3. เพิ่มรายการ BOQ:
```
1. งานเทคอนกรีตพื้น - 150 ตร.ม.
2. งานก่ออิฐผนัง - 300 ตร.ม.
3. งานติดตั้งไฟฟ้า - 80 จุด
4. งานทาสีภายใน - 500 ตร.ม.
5. งานติดตั้งประตู-หน้าต่าง - 25 ชุด
```

### 4. คลิก "วิเคราะห์ BOQ และถอดรายการ"

### 5. ดูผลลัพธ์ 4 Tab:
- **สรุป** - ภาพรวมทั้งหมด
- **วัสดุ** - รายการวัสดุรวม
- **แรงงาน** - รายการแรงงานรวม
- **เครื่องมือ** - รายการเครื่องมือรวม

---

## 📊 ผลลัพธ์ที่ได้

### Tab 1: สรุป
```
┌─────────────────────────────────┐
│ สรุปผลการวิเคราะห์              │
│                                  │
│ งบประมาณ:      15,000,000 บาท  │
│ ต้นทุนรวม:     12,500,000 บาท  │
│ กำไรสุทธิ:      2,500,000 บาท  │
│ กำไร %:              16.7%      │
│                                  │
│ รายการทั้งหมด:  5 รายการ        │
│                                  │
│ ต้นทุนแยกตาม:                   │
│ 💰 วัสดุ:        8,000,000      │
│ 👷 แรงงาน:      3,000,000      │
│ 🔧 เครื่องมือ:    500,000      │
│ 📋 ค่าบริหาร:     805,000      │
│ 💳 ภาษี VAT:      195,000      │
└─────────────────────────────────┘
```

### Tab 2: วัสดุ (รวมทั้งโครงการ)
```
┌─────────────────────────────────┐
│ 📦 รายการวัสดุรวม               │
│                                  │
│ 1. คอนกรีตผสมเสร็จ              │
│    fc = 240 kg/cm²              │
│    จำนวน: 157.5 ลบ.ม.          │
│    ราคา: 2,800 บาท/ลบ.ม.       │
│    รวม: 441,000 บาท             │
│    ใช้ในรายการ: 1               │
│                                  │
│ 2. เหล็กเส้น SD40, DB12         │
│    จำนวน: 18,000 กก.           │
│    ราคา: 25 บาท/กก.            │
│    รวม: 450,000 บาท             │
│    ใช้ในรายการ: 1               │
│                                  │
│ 3. อิฐมอญ 3 รู                  │
│    จำนวน: 22,500 ก้อน          │
│    ราคา: 3.5 บาท/ก้อน          │
│    รวม: 78,750 บาท              │
│    ใช้ในรายการ: 2               │
└─────────────────────────────────┘
```

### Tab 3: แรงงาน (รวมทั้งโครงการ)
```
┌─────────────────────────────────┐
│ 👷 รายการแรงงานรวม              │
│                                  │
│ 1. หัวหน้างาน (Foreman)         │
│    🔷 หัวหน้างาน                │
│    วันคน: 15 วัน                │
│    ค่าจ้าง: 800 บาท/วัน         │
│    รวม: 12,000 บาท              │
│    ใช้ในรายการ: 1, 2            │
│                                  │
│ 2. ช่างเทคอนกรีต (Skilled)      │
│    ⭐ ช่างฝีมือ                  │
│    วันคน: 45 วัน                │
│    ค่าจ้าง: 600 บาท/วัน         │
│    รวม: 27,000 บาท              │
│    ใช้ในรายการ: 1               │
│                                  │
│ 3. ช่างก่อ (Skilled)            │
│    ⭐ ช่างฝีมือ                  │
│    วันคน: 120 วัน               │
│    ค่าจ้าง: 600 บาท/วัน         │
│    รวม: 72,000 บาท              │
│    ใช้ในรายการ: 2               │
└─────────────────────────────────┘
```

### Tab 4: เครื่องมือ
```
┌─────────────────────────────────┐
│ 🔧 รายการเครื่องมือรวม          │
│                                  │
│ 1. เครื่องผสมคอนกรีต            │
│    🔄 เช่า                       │
│    ใช้งาน: 75 วัน               │
│    ค่าเช่า: 500 บาท/วัน         │
│    รวม: 37,500 บาท              │
│    ใช้ในรายการ: 1               │
│                                  │
│ 2. เครื่องสั่นคอนกรีต           │
│    🏠 เป็นของเรา                │
│    ใช้งาน: 45 วัน               │
│    ค่าเสื่อม: 4,500 บาท         │
│    ใช้ในรายการ: 1               │
└─────────────────────────────────┘
```

---

## 💡 ฐานข้อมูลการถอดรายการ

### งานคอนกรีต:
- **วัสดุ:** คอนกรีต (1.05 ลบ.ม./ตร.ม.), เหล็ก (120 กก./ลบ.ม.)
- **แรงงาน:** หัวหน้า (0.1), ช่าง (0.3), ผู้ช่วย (0.5) วันคน/ลบ.ม.
- **เครื่องมือ:** เครื่องผสม, เครื่องสั่น

### งานก่ออิฐ:
- **วัสดุ:** อิฐ (75 ก้อน/ตร.ม.), ปูน (1.2 ถุง/ตร.ม.), ทราย (0.03 ลบ.ม./ตร.ม.)
- **แรงงาน:** ช่างก่อ (0.4), ผู้ช่วย (0.4) วันคน/ตร.ม.

### งานไฟฟ้า:
- **วัสดุ:** สายไฟ (15 ม./จุด), เต้ารับ (1 ชุด/จุด)
- **แรงงาน:** ช่างไฟฟ้า (0.2 วันคน/จุด)
- **เครื่องมือ:** สว่านไฟฟ้า

### งานทาสี:
- **วัสดุ:** สีทา (0.15 แกลลอน/ตร.ม.), สีรองพื้น (0.1 แกลลอน/ตร.ม.)
- **แรงงาน:** ช่างทาสี (0.15 วันคน/ตร.ม.)

---

## 🎨 ตัวอย่างโครงการเต็ม

### โครงการ: อาคารสำนักงาน 3 ชั้น
**งบประมาณ:** 15,000,000 บาท

**BOQ:**
```
1. งานเทคอนกรีตพื้น       150 ตร.ม.
2. งานก่ออิฐผนัง          300 ตร.ม.
3. งานติดตั้งไฟฟ้า         80 จุด
4. งานทาสีภายใน          500 ตร.ม.
5. งานติดตั้งประตู-หน้าต่าง 25 ชุด
```

**ผลการวิเคราะห์:**

#### วัสดุรวม (15 รายการ):
```
1. คอนกรีต:        157.5 ลบ.ม.  =    441,000 บาท
2. เหล็กเส้น:     18,000 กก.    =    450,000 บาท
3. อิฐมอญ:        22,500 ก้อน   =     78,750 บาท
4. ปูนซีเมนต์:       360 ถุง    =     54,000 บาท
5. ทรายหยาบ:          9 ลบ.ม.  =      3,600 บาท
6. สายไฟ:         1,200 เมตร   =     14,400 บาท
7. เต้ารับ:           80 ชุด    =      6,800 บาท
8. สีทา:              75 แกลลอน =     63,750 บาท
9. สีรองพื้น:         50 แกลลอน =     32,500 บาท
...
รวมวัสดุ: 8,500,000 บาท
```

#### แรงงานรวม (8 ประเภท):
```
1. หัวหน้างาน:     15 วันคน × 800 =  12,000 บาท
2. ช่างเทคอนกรีต:  45 วันคน × 600 =  27,000 บาท
3. ช่างก่อ:       120 วันคน × 600 =  72,000 บาท
4. ช่างไฟฟ้า:      16 วันคน × 700 =  11,200 บาท
5. ช่างทาสี:       75 วันคน × 550 =  41,250 บาท
6. ผู้ช่วย:       200 วันคน × 400 =  80,000 บาท
...
รวมแรงงาน: 3,200,000 บาท
```

#### เครื่องมือรวม (5 รายการ):
```
1. เครื่องผสมคอนกรีต:  75 วัน × 500 = 37,500 บาท
2. เครื่องสั่นคอนกรีต:  45 วัน (เสื่อม) = 4,500 บาท
3. สว่านไฟฟ้า:          8 วัน (เสื่อม) =   400 บาท
...
รวมเครื่องมือ: 450,000 บาท
```

#### สรุปต้นทุน:
```
ต้นทุนตรง:           12,150,000 บาท
ค่าใช้จ่ายทั่วไป (10%): 1,215,000 บาท
ค่าบริหาร (7%):         850,500 บาท
ค่าสำรอง (5%):          607,500 บาท
ภาษี VAT (7%):          910,350 บาท
─────────────────────────────────
รวมต้นทุน:          15,733,350 บาท
งบประมาณ:           15,000,000 บาท
─────────────────────────────────
กำไร/ขาดทุน:          -733,350 บาท ❌
```

**คำแนะนำ:** ต้นทุนสูงกว่างบประมาณ ควรลดต้นทุนหรือไม่รับงาน

---

## 🎯 Use Cases

### 1. ประมาณการต้นทุนเบื้องต้น
- ใส่รายการ BOQ คร่าวๆ
- ระบบถอดวัสดุและแรงงานให้
- ได้ต้นทุนประมาณการทันที

### 2. ตรวจสอบความคุ้มค่า
- วิเคราะห์ว่าโครงการนี้ทำกำไรได้หรือไม่
- เปรียบเทียบงบประมาณกับต้นทุน

### 3. จัดทำใบเสนอราคา
- ได้รายการวัสดุครบถ้วน
- ได้จำนวนแรงงานที่ต้องการ
- คำนวณราคาได้แม่นยำ

### 4. วางแผนจัดซื้อ
- รู้ว่าต้องซื้อวัสดุอะไรบ้าง
- รู้จำนวนที่แน่นอน
- วางแผนการสั่งซื้อล่วงหน้า

### 5. วางแผนแรงงาน
- รู้ว่าต้องการช่างประเภทไหน
- รู้จำนวนวันคน
- จัดตารางงานได้

---

## 🔥 ฟีเจอร์พิเศษ

### 1. **Auto Material Extraction**
ระบบจะถอดวัสดุอัตโนมัติตามรายการงาน:
- งานคอนกรีต → คอนกรีต, เหล็ก
- งานก่ออิฐ → อิฐ, ปูน, ทราย
- งานไฟฟ้า → สายไฟ, เต้ารับ
- งานทาสี → สี, สีรองพื้น

### 2. **Labor Calculation**
คำนวณแรงงานตามฝีมือ:
- 🔷 Foreman (หัวหน้า) - 800 บาท/วัน
- ⭐ Skilled (ช่างฝีมือ) - 550-700 บาท/วัน
- 👷 Helper (ผู้ช่วย) - 400 บาท/วัน

### 3. **Equipment Tracking**
แยกเครื่องมือ:
- 🏠 เป็นของเรา - คิดค่าเสื่อม
- 🔄 เช่า - คิดค่าเช่าต่อวัน

### 4. **Waste Factor**
คำนวณ waste ให้อัตโนมัติ:
- คอนกรีต: +5%
- อิฐ: +3%
- สี: +10%

---

## 🎉 สรุป

**BOQ Analyzer พร้อมใช้งาน!**

### ความสามารถ:
- ✅ ถอดวัสดุอัตโนมัติ
- ✅ คำนวณแรงงาน (Man-days)
- ✅ คำนวณเครื่องมือ
- ✅ รวมรายการทั้งโครงการ
- ✅ คำนวณกำไรสุทธิ
- ✅ คำนวณ Timeline

### ไฟล์ที่สร้าง:
1. ✅ `src/lib/boq-analyzer.ts`
2. ✅ `src/app/api/analyze-boq/route.ts`
3. ✅ `src/app/boq-analyzer/page.tsx`

---

**เปิดใช้งานได้เลย:** `http://localhost:3000/boq-analyzer` 🚀
